name: 'Docs: Create bundle'

on:
    pull_request:
        types: [synchronize, opened, reopened]
        paths:
            - .github/workflows/docs-bundle.yml
            - doc
    workflow_dispatch:
        inputs:
            ref:
                description:
                    Ref (Tag, branch, commit SHA) to publish the docs from.
                    Defaults to the main branch.
                type: string

jobs:
    echo-inputs:
        runs-on: ubuntu-latest
        name: Inputs
        steps:
            - uses: actions/github-script@v8
              if: github.event_name == 'workflow_dispatch'
              env:
                  REF: ${{ inputs.ref }}
                  FALLBACK_REF: ${{ github.ref_name }}
              with:
                  script: |
                      core.summary.addHeading('Workflow inputs', '2');
                      core.summary.addTable([['Ref', process.env.REF ? `<code>${process.env.REF}</code>` : `not set explicitly, using ref <code>${process.env.FALLBACK_REF}</code>`]]);
                      core.summary.write();
    create-doc-bundle:
        uses: NordicSemiconductor/pc-nrfconnect-shared/.github/workflows/docs-bundle.yml@main
        with:
            bundle-name: nrf-connect-desktop
            ref: ${{ inputs.ref }}
